---
logLevel: INFO
service:
  bu: ${{ values.labels.businessUnit }}
  team: ${{ values.service.team }}
  project: ${{ values.service.bitbucketProjectKey }}
  name: ${{ values.service.name }}
  runtime: ${{ values.service.runtime }}

build:
  tool: ${{ values.service.buildTool }}
  subCommands:
    {%- if values.service.buildTool=='npm' %}
    - install
    {%- elif values.service.buildTool=='pip' %}
    - install
    {%- elif values.service.buildTool=='mvn' %}
    - clean package -U -P profile-server -D maven.test.skip=true
    {%- elif values.service.buildTool=='gradle' %}
    - build
    {%- endif %}

allowImageWithVulnerabilities: true

environments:
  dev:
    branches:
      feature/*:
        ciOnly: true
        namespaces:
          - ${{ values.k8s.commonNamespaces[0] }}
      develop:
        namespaces: [${{ values.k8s.commonNamespaces }}]

  qa:
    branches:
      release/*:
        namespaces:
          - ${{ values.k8s.commonNamespaces[0] }}
      hotfix/*:
        namespaces:
          - ${{ values.k8s.commonNamespaces[0] }}
      master:
        namespaces: [${{ values.k8s.commonNamespaces }}]
